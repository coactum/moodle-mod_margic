define ("mod_margic/text-range",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.TextRange=a.TextPosition=a.RESOLVE_BACKWARDS=a.RESOLVE_FORWARDS=void 0;function b(a,b){return g(a)||f(a,b)||d(a,b)||c()}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(a,b){if(!a)return;if("string"==typeof a)return e(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return e(a,b)}function e(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function f(a,b){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(a)))return;var c=[],d=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(d=(h=g.next()).done);d=!0){c.push(h.value);if(b&&c.length===b)break}}catch(a){e=!0;f=a}finally{try{if(!d&&null!=g["return"])g["return"]()}finally{if(e)throw f}}return c}function g(a){if(Array.isArray(a))return a}function h(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function i(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function j(a,b,c){if(b)i(a.prototype,b);if(c)i(a,c);return a}function k(a){switch(a.nodeType){case Node.ELEMENT_NODE:case Node.TEXT_NODE:return a.textContent.length;default:return 0;}}function l(a){var b=a.previousSibling,c=0;while(b){c+=k(b);b=b.previousSibling}return c}function m(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++){c[d-1]=arguments[d]}var e=c.shift(),f=a.ownerDocument.createNodeIterator(a,NodeFilter.SHOW_TEXT),g=[],h=f.nextNode(),i,j=0;while(e!==void 0&&h){i=h;if(j+i.data.length>e){g.push({node:i,offset:e-j});e=c.shift()}else{h=f.nextNode();j+=i.data.length}}while(e!==void 0&&j===e){g.push({node:i,offset:i.data.length});e=c.shift()}if(e!==void 0){throw new RangeError("Offset exceeds text length")}return g}a.RESOLVE_FORWARDS=1;a.RESOLVE_BACKWARDS=2;var n=function(){function a(b,c){h(this,a);if(0>c){throw new Error("Offset is invalid")}this.element=b;this.offset=c}j(a,[{key:"relativeTo",value:function relativeTo(b){if(!b.contains(this.element)){throw new Error("Parent is not an ancestor of current element")}var c=this.element,d=this.offset;while(c!==b){d+=l(c);c=c.parentElement}return new a(c,d)}},{key:"resolve",value:function resolve(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};try{return m(this.element,this.offset)[0]}catch(e){if(0===this.offset&&a.direction!==void 0){var d=document.createTreeWalker(this.element.getRootNode(),NodeFilter.SHOW_TEXT);d.currentNode=this.element;var b=a.direction===1,c=b?d.nextNode():d.previousNode();if(!c){throw e}return{node:c,offset:b?0:c.data.length}}else{throw e}}}}],[{key:"fromCharOffset",value:function fromCharOffset(b,c){switch(b.nodeType){case Node.TEXT_NODE:return a.fromPoint(b,c);case Node.ELEMENT_NODE:return new a(b,c);default:throw new Error("Node is not an element or text node");}}},{key:"fromPoint",value:function fromPoint(b,c){switch(b.nodeType){case Node.TEXT_NODE:{if(0>c||c>b.data.length){throw new Error("Text node offset is out of range")}if(!b.parentElement){throw new Error("Text node has no parent")}var f=l(b)+c;return new a(b.parentElement,f)}case Node.ELEMENT_NODE:{if(0>c||c>b.childNodes.length){throw new Error("Child node offset is out of range")}for(var d=0,e=0;e<c;e++){d+=k(b.childNodes[e])}return new a(b,d)}default:throw new Error("Point is not in an element or text node");}}}]);return a}();a.TextPosition=n;var o=function(){function a(b,c){h(this,a);this.start=b;this.end=c}j(a,[{key:"relativeTo",value:function relativeTo(b){return new a(this.start.relativeTo(b),this.end.relativeTo(b))}},{key:"toRange",value:function toRange(){var a,c;if(this.start.element===this.end.element&&this.start.offset<=this.end.offset){var d=m(this.start.element,this.start.offset,this.end.offset),e=b(d,2);a=e[0];c=e[1]}else{a=this.start.resolve({direction:1});c=this.end.resolve({direction:2})}var f=new Range;f.setStart(a.node,a.offset);f.setEnd(c.node,c.offset);return f}}],[{key:"fromRange",value:function fromRange(b){var c=n.fromPoint(b.startContainer,b.startOffset),d=n.fromPoint(b.endContainer,b.endOffset);return new a(c,d)}},{key:"fromOffsets",value:function fromOffsets(b,c,d){return new a(new n(b,c),new n(b,d))}}]);return a}();a.TextRange=o});
//# sourceMappingURL=text-range.min.js.map
