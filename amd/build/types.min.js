define ("mod_margic/types",["exports","./match-quote","./text-range","./xpath"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.TextQuoteAnchor=a.TextPositionAnchor=a.RangeAnchor=void 0;function e(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function f(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){e(Object(c),!0).forEach(function(b){g(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{e(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function g(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}function h(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function i(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function j(a,b,c){if(b)i(a.prototype,b);if(c)i(a,c);return a}var k=function(){function a(b,c){h(this,a);this.root=b;this.range=c}j(a,[{key:"toRange",value:function toRange(){return this.range}},{key:"toSelector",value:function toSelector(){var a=c.TextRange.fromRange(this.range).toRange(),b=c.TextRange.fromRange(a),e=(0,d.xpathFromNode)(b.start.element,this.root),f=(0,d.xpathFromNode)(b.end.element,this.root);return{type:"RangeSelector",startContainer:e,startOffset:b.start.offset,endContainer:f,endOffset:b.end.offset}}}],[{key:"fromRange",value:function fromRange(b,c){return new a(b,c)}},{key:"fromSelector",value:function fromSelector(b,e){var f=(0,d.nodeFromXPath)(e.startContainer,b);if(!f){throw new Error("Failed to resolve startContainer XPath")}var g=(0,d.nodeFromXPath)(e.endContainer,b);if(!g){throw new Error("Failed to resolve endContainer XPath")}var h=c.TextPosition.fromCharOffset(f,e.startOffset),i=c.TextPosition.fromCharOffset(g,e.endOffset),j=new c.TextRange(h,i).toRange();return new a(b,j)}}]);return a}();a.RangeAnchor=k;var l=function(){function a(b,c,d){h(this,a);this.root=b;this.start=c;this.end=d}j(a,[{key:"toSelector",value:function toSelector(){return{type:"TextPositionSelector",start:this.start,end:this.end}}},{key:"toRange",value:function toRange(){return c.TextRange.fromOffsets(this.root,this.start,this.end).toRange()}}],[{key:"fromRange",value:function fromRange(b,d){var e=c.TextRange.fromRange(d).relativeTo(b);return new a(b,e.start.offset,e.end.offset)}},{key:"fromSelector",value:function fromSelector(b,c){return new a(b,c.start,c.end)}}]);return a}();a.TextPositionAnchor=l;var m=function(){function a(b,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};h(this,a);this.root=b;this.exact=c;this.context=d}j(a,[{key:"toSelector",value:function toSelector(){return{type:"TextQuoteSelector",exact:this.exact,prefix:this.context.prefix,suffix:this.context.suffix}}},{key:"toRange",value:function toRange(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return this.toPositionAnchor(a).toRange()}},{key:"toPositionAnchor",value:function toPositionAnchor(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},c=this.root.textContent,d=(0,b.matchQuote)(c,this.exact,f({},this.context,{hint:a.hint}));if(!d){throw new Error("Quote not found")}return new l(this.root,d.start,d.end)}}],[{key:"fromRange",value:function fromRange(b,d){var e=b.textContent,f=c.TextRange.fromRange(d).relativeTo(b),g=f.start.offset,h=f.end.offset,i=32;return new a(b,e.slice(g,h),{prefix:e.slice(Math.max(0,g-i),g),suffix:e.slice(h,Math.min(e.length,h+i))})}},{key:"fromSelector",value:function fromSelector(b,c){var d=c.prefix,e=c.suffix;return new a(b,c.exact,{prefix:d,suffix:e})}}]);return a}();a.TextQuoteAnchor=m});
//# sourceMappingURL=types.min.js.map
