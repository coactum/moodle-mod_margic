define("mod_margic/match-quote",["exports","approx-string-match"],(function(_exports,_approxStringMatch){var obj;function search(text,str,maxErrors){for(var matchPos=0,exactMatches=[];-1!==matchPos;)-1!==(matchPos=text.indexOf(str,matchPos))&&(exactMatches.push({start:matchPos,end:matchPos+str.length,errors:0}),matchPos+=1);return exactMatches.length>0?exactMatches:(0,_approxStringMatch.default)(text,str,maxErrors)}function textMatchScore(text,str){return 0===str.length||0===text.length?0:1-search(text,str,str.length)[0].errors/str.length}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.matchQuote=function(text,quote){var context=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(0===quote.length)return null;var maxErrors=Math.min(256,quote.length/2),matches=search(text,quote,maxErrors);if(0===matches.length)return null;var scoreMatch=function(match){var quoteScore=1-match.errors/quote.length,prefixScore=context.prefix?textMatchScore(text.slice(Math.max(0,match.start-context.prefix.length),match.start),context.prefix):1,suffixScore=context.suffix?textMatchScore(text.slice(match.end,match.end+context.suffix.length),context.suffix):1,posScore=1;"number"==typeof context.hint&&(posScore=1-Math.abs(match.start-context.hint)/text.length);return(50*quoteScore+20*prefixScore+20*suffixScore+2*posScore)/92},scoredMatches=matches.map((function(m){return{start:m.start,end:m.end,score:scoreMatch(m)}}));return scoredMatches.sort((function(a,b){return b.score-a.score})),scoredMatches[0]},_approxStringMatch=(obj=_approxStringMatch)&&obj.__esModule?obj:{default:obj}}));

//# sourceMappingURL=match-quote.min.js.map