{"version":3,"file":"annotations.min.js","sources":["../src/annotations.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Module for the annotation functions of the margic.\n *\n * @module     mod_margic/annotations\n * @copyright  2022 coactum GmbH\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport {removeAllTempHighlights, anchor, describe} from './highlighting';\n\nexport const init = (cmid, canmakeannotations, myuserid, focusannotation) => {\n\n    var edited = false;\n    var annotations = Array();\n\n    var newannotation = false;\n\n    // Remove col-mds from moodle form.\n    $('.annotation-form div.col-md-3').removeClass('col-md-3');\n    $('.annotation-form div.col-md-9').removeClass('col-md-9');\n    $('.annotation-form div.form-group').removeClass('form-group');\n    $('.annotation-form div.row').removeClass('row');\n\n    // Onclick listener if form is canceled.\n    $(document).on('click', '#id_cancel', function(e) {\n        e.preventDefault();\n\n        removeAllTempHighlights(); // Remove other temporary highlights.\n\n        resetForms(); // Remove old form contents.\n\n        edited = false;\n    });\n\n    // Listen for return key pressed to submit annotation form.\n    $('textarea').keypress(function(e) {\n        if (e.which == 13) {\n            $(this).parents(':eq(2)').submit();\n            e.preventDefault();\n        }\n    });\n\n    // If user selects text for new annotation\n    $(document).on('mouseup', '.originaltext', function() {\n        var selectedrange = window.getSelection().getRangeAt(0);\n\n        if (selectedrange.cloneContents().textContent !== '' && canmakeannotations) {\n\n            removeAllTempHighlights(); // Remove other temporary highlights.\n\n            resetForms(); // Reset the annotation forms.\n\n            // Create new annotation.\n            newannotation = createAnnotation(this);\n\n            var entry = this.id.replace(/entry-/, '');\n\n            // RangeSelector.\n            $('.annotation-form-' + entry + ' input[name=\"startcontainer\"]').val(\n                newannotation.target[0].selector[0].startContainer);\n            $('.annotation-form-' + entry + ' input[name=\"endcontainer\"]').val(\n                newannotation.target[0].selector[0].endContainer);\n            $('.annotation-form-' + entry + ' input[name=\"startoffset\"]').val(\n                newannotation.target[0].selector[0].startOffset);\n            $('.annotation-form-' + entry + ' input[name=\"endoffset\"]').val(\n                newannotation.target[0].selector[0].endOffset);\n\n            // TextPositionSelector.\n            $('.annotation-form-' + entry + ' input[name=\"annotationstart\"]').val(\n                newannotation.target[0].selector[1].start);\n            $('.annotation-form-' + entry + ' input[name=\"annotationend\"]').val(\n                newannotation.target[0].selector[1].end);\n\n            // TextQuoteSelector.\n            $('.annotation-form-' + entry + ' input[name=\"exact\"]').val(\n                newannotation.target[0].selector[2].exact);\n            $('.annotation-form-' + entry + ' input[name=\"prefix\"]').val(\n                newannotation.target[0].selector[2].prefix);\n            $('.annotation-form-' + entry + ' input[name=\"suffix\"]').val(\n                newannotation.target[0].selector[2].suffix);\n\n            $('.annotation-form-' + entry + ' select').val(1);\n\n            // Prevent JavaScript injection (if annotated text in original entry is JavaScript code in script tags).\n            $('#annotationpreview-temp-' + entry).html(\n                newannotation.target[0].selector[2].exact.replaceAll('<', '&lt;').replaceAll('>', '&gt;'));\n\n            $('.annotationarea-' + entry + ' .annotation-form').show();\n            $('.annotation-form-' + entry + ' #id_text').focus();\n        }\n    });\n\n    // Fetch and recreate annotations.\n    $.ajax({\n        url: './annotations.php',\n        data: {'id': cmid, 'getannotations': 1},\n        success: function(response) {\n            annotations = JSON.parse(response);\n            recreateAnnotations();\n\n            // Highlight annotation and all annotated text if annotated text is hovered\n            $('.annotated').mouseenter(function() {\n                var id = this.id.replace('annotated-', '');\n                $('.annotation-box-' + id).addClass('hovered');\n                $('.annotated-' + id).css(\"background-color\", 'lightblue');\n            });\n\n            $('.annotated').mouseleave(function() {\n                var id = this.id.replace('annotated-', '');\n                $('.annotation-box-' + id).removeClass('hovered');\n                $('.annotated-' + id).css(\"background-color\", $('.annotated-' + id).css('textDecorationColor'));\n            });\n\n            // Highlight whole temp annotation if part of temp annotation is hovered\n            $(document).on('mouseover', '.annotated_temp', function() {\n                $('.annotated_temp').addClass('hovered');\n            });\n\n            $(document).on('mouseleave', '.annotated_temp', function() {\n                $('.annotated_temp').removeClass('hovered');\n            });\n\n            // Onclick listener for editing annotation.\n            $(document).on('click', '.annotated', function() {\n                var id = this.id.replace('annotated-', '');\n                editAnnotation(id);\n            });\n\n            // Onclick listener for editing annotation.\n            $(document).on('click', '.edit-annotation', function() {\n                var id = this.id.replace('edit-annotation-', '');\n                editAnnotation(id);\n            });\n\n            // Highlight annotation if hoverannotation button is hovered\n            $(document).on('mouseover', '.hoverannotation', function() {\n                var id = this.id.replace('hoverannotation-', '');\n                $('.annotated-' + id).css(\"background-color\", 'lightblue');\n            });\n\n            $(document).on('mouseleave', '.hoverannotation', function() {\n                var id = this.id.replace('hoverannotation-', '');\n                $('.annotated-' + id).css(\"background-color\", $('.annotated-' + id).css('textDecorationColor'));\n            });\n\n\n            // Focus annotation if needed.\n            if (focusannotation != 0) {\n                $('.annotated-' + focusannotation).attr('tabindex', -1);\n                $('.annotated-' + focusannotation).focus();\n            }\n\n        },\n        complete: function() {\n            $('#overlay').hide();\n        },\n        error: function() {\n            // For output: alert('Error fetching annotations');\n        }\n    });\n\n    /**\n     * Recreate annotations.\n     *\n     */\n    function recreateAnnotations() {\n\n        for (let annotation of Object.values(annotations)) {\n\n            const rangeSelectors = [[\n                {type: \"RangeSelector\", startContainer: annotation.startcontainer, startOffset: parseInt(annotation.startoffset),\n                endContainer: annotation.endcontainer, endOffset: parseInt(annotation.endoffset)},\n                {type: \"TextPositionSelector\", start: parseInt(annotation.annotationstart),\n                end: parseInt(annotation.annotationend)},\n                {type: \"TextQuoteSelector\", exact: annotation.exact, prefix: annotation.prefix, suffix: annotation.suffix}\n            ]];\n\n            const target = rangeSelectors.map(selectors => ({\n                selector: selectors,\n            }));\n\n            /** @type {AnnotationData} */\n            const newannotation = {\n                annotation: annotation,\n                target: target,\n            };\n\n            anchor(newannotation, $(\"#entry-\" + annotation.entry)[0]);\n        }\n    }\n\n    /**\n     * Edit annotation.\n     *\n     * @param {int} annotationid\n     */\n    function editAnnotation(annotationid) {\n\n        if (edited == annotationid) {\n            removeAllTempHighlights(); // Remove other temporary highlights.\n            resetForms(); // Remove old form contents.\n            edited = false;\n        } else if (canmakeannotations && myuserid == annotations[annotationid].userid) {\n            removeAllTempHighlights(); // Remove other temporary highlights.\n            resetForms(); // Remove old form contents.\n\n            edited = annotationid;\n\n            var entry = annotations[annotationid].entry;\n\n            $('.annotation-box-' + annotationid).hide(); // Hide edited annotation-box.\n\n            $('.annotation-form-' + entry + ' input[name=\"startcontainer\"]').val(annotations[annotationid].startcontainer);\n            $('.annotation-form-' + entry + ' input[name=\"endcontainer\"]').val(annotations[annotationid].endcontainer);\n            $('.annotation-form-' + entry + ' input[name=\"startoffset\"]').val(annotations[annotationid].startoffset);\n            $('.annotation-form-' + entry + ' input[name=\"endoffset\"]').val(annotations[annotationid].endoffset);\n            $('.annotation-form-' + entry + ' input[name=\"annotationstart\"]').val(annotations[annotationid].annotationstart);\n            $('.annotation-form-' + entry + ' input[name=\"annotationend\"]').val(annotations[annotationid].annotationend);\n            $('.annotation-form-' + entry + ' input[name=\"exact\"]').val(annotations[annotationid].exact);\n            $('.annotation-form-' + entry + ' input[name=\"prefix\"]').val(annotations[annotationid].prefix);\n            $('.annotation-form-' + entry + ' input[name=\"suffix\"]').val(annotations[annotationid].suffix);\n\n            $('.annotation-form-' + entry + ' input[name=\"annotationid\"]').val(annotationid);\n\n            $('.annotation-form-' + entry + ' textarea[name=\"text\"]').val(annotations[annotationid].text);\n\n            $('.annotation-form-' + entry + ' select').val(annotations[annotationid].type);\n\n            // Prevent JavaScript injection (if annotated text in original entry is JavaScript code in script tags).\n            $('#annotationpreview-temp-' + entry).html(\n                annotations[annotationid].exact.replaceAll('<', '&lt;').replaceAll('>', '&gt;'));\n            $('#annotationpreview-temp-' + entry).css('border-color', '#' + annotations[annotationid].color);\n\n            $('.annotationarea-' + entry + ' .annotation-form').insertBefore('.annotation-box-' + annotationid);\n            $('.annotationarea-' + entry + ' .annotation-form').show();\n            $('.annotationarea-' + entry + ' #id_text').focus();\n        } else {\n            $('.annotation-box-' + annotationid).focus();\n        }\n    }\n\n    /**\n     * Reset all annotation forms\n     */\n    function resetForms() {\n        $('.annotation-form').hide();\n\n        $('.annotation-form input[name^=\"annotationid\"]').val(null);\n\n        $('.annotation-form input[name^=\"startcontainer\"]').val(-1);\n        $('.annotation-form input[name^=\"endcontainer\"]').val(-1);\n        $('.annotation-form input[name^=\"startoffset\"]').val(-1);\n        $('.annotation-form input[name^=\"endoffset\"]').val(-1);\n\n        $('.annotation-form textarea[name^=\"text\"]').val('');\n\n        $('.annotation-box').not('.annotation-form').show(); // To show again edited annotation.\n    }\n};\n\n/**\n * Create a new annotation that is associated with the selected region of\n * the current document.\n *\n * @param {object} root - The root element\n * @return {object} - The new annotation\n */\nfunction createAnnotation(root) {\n    const ranges = [window.getSelection().getRangeAt(0)];\n\n    if (ranges.collapsed) {\n        return null;\n    }\n\n    const rangeSelectors = ranges.map(range => describe(root, range));\n\n    const target = rangeSelectors.map(selectors => ({\n      selector: selectors,\n    }));\n\n    /** @type {AnnotationData} */\n    const annotation = {\n      target,\n    };\n\n    anchor(annotation, root);\n\n    return annotation;\n}"],"names":["obj","_jquery","__esModule","default","_exports","init","cmid","canmakeannotations","myuserid","focusannotation","edited","annotations","Array","newannotation","editAnnotation","annotationid","removeAllTempHighlights","resetForms","userid","entry","$","hide","val","startcontainer","endcontainer","startoffset","endoffset","annotationstart","annotationend","exact","prefix","suffix","text","type","html","replaceAll","css","color","insertBefore","show","focus","not","removeClass","document","on","e","preventDefault","keypress","which","this","parents","submit","window","getSelection","getRangeAt","cloneContents","textContent","root","ranges","collapsed","rangeSelectors","map","range","describe","annotation","target","selectors","selector","anchor","createAnnotation","id","replace","startContainer","endContainer","startOffset","endOffset","start","end","ajax","url","data","getannotations","success","response","JSON","parse","Object","values","parseInt","recreateAnnotations","mouseenter","addClass","mouseleave","attr","complete","error"],"mappings":"gHAuBuB,IAAAA;;;;;;;kFAAvBC,SAAuBD,IAAvBC,UAAuBD,IAAAE,WAAAF,IAAAG,CAAAA,QAAAH,KA2PrBI,SAAAC,KAxPkBA,CAACC,KAAMC,mBAAoBC,SAAUC,mBAErD,IAAIC,QAAS,EACTC,YAAcC,QAEdC,eAAgB,EAqLpB,SAASC,eAAeC,cAEpB,GAAIL,QAAUK,cACV,EAAAC,yCACAC,aACAP,QAAS,OACN,GAAIH,oBAAsBC,UAAYG,YAAYI,cAAcG,OAAQ,EAC3E,EAAAF,yCACAC,aAEAP,OAASK,aAET,IAAII,MAAQR,YAAYI,cAAcI,OAEtC,EAAAC,QAAAA,SAAE,mBAAqBL,cAAcM,QAErC,EAAAD,iBAAE,oBAAsBD,MAAQ,iCAAiCG,IAAIX,YAAYI,cAAcQ,iBAC/F,EAAAH,iBAAE,oBAAsBD,MAAQ,+BAA+BG,IAAIX,YAAYI,cAAcS,eAC7F,EAAAJ,iBAAE,oBAAsBD,MAAQ,8BAA8BG,IAAIX,YAAYI,cAAcU,cAC5F,EAAAL,iBAAE,oBAAsBD,MAAQ,4BAA4BG,IAAIX,YAAYI,cAAcW,YAC1F,EAAAN,iBAAE,oBAAsBD,MAAQ,kCAAkCG,IAAIX,YAAYI,cAAcY,kBAChG,EAAAP,iBAAE,oBAAsBD,MAAQ,gCAAgCG,IAAIX,YAAYI,cAAca,gBAC9F,EAAAR,iBAAE,oBAAsBD,MAAQ,wBAAwBG,IAAIX,YAAYI,cAAcc,QACtF,EAAAT,iBAAE,oBAAsBD,MAAQ,yBAAyBG,IAAIX,YAAYI,cAAce,SACvF,EAAAV,iBAAE,oBAAsBD,MAAQ,yBAAyBG,IAAIX,YAAYI,cAAcgB,SAEvF,EAAAX,QAACjB,SAAC,oBAAsBgB,MAAQ,+BAA+BG,IAAIP,eAEnE,EAAAK,iBAAE,oBAAsBD,MAAQ,0BAA0BG,IAAIX,YAAYI,cAAciB,OAExF,EAAAZ,iBAAE,oBAAsBD,MAAQ,WAAWG,IAAIX,YAAYI,cAAckB,OAGzE,EAAAb,QAACjB,SAAC,2BAA6BgB,OAAOe,KAClCvB,YAAYI,cAAcc,MAAMM,WAAW,IAAK,QAAQA,WAAW,IAAK,UAC5E,EAAAf,iBAAE,2BAA6BD,OAAOiB,IAAI,eAAgB,IAAMzB,YAAYI,cAAcsB,QAE1F,EAAAjB,QAACjB,SAAC,mBAAqBgB,MAAQ,qBAAqBmB,aAAa,mBAAqBvB,eACtF,EAAAK,QAAAA,SAAE,mBAAqBD,MAAQ,qBAAqBoB,QACpD,EAAAnB,QAAAA,SAAE,mBAAqBD,MAAQ,aAAaqB,OAChD,MACI,EAAApB,QAAAA,SAAE,mBAAqBL,cAAcyB,OAE7C,CAKA,SAASvB,cACL,EAAAG,iBAAE,oBAAoBC,QAEtB,EAAAD,QAAAA,SAAE,gDAAgDE,IAAI,OAEtD,EAAAF,QAAAA,SAAE,kDAAkDE,KAAK,IACzD,EAAAF,QAAAA,SAAE,gDAAgDE,KAAK,IACvD,EAAAF,QAAAA,SAAE,+CAA+CE,KAAK,IACtD,EAAAF,QAAAA,SAAE,6CAA6CE,KAAK,IAEpD,EAAAF,QAAAA,SAAE,2CAA2CE,IAAI,KAEjD,EAAAF,QAAAA,SAAE,mBAAmBqB,IAAI,oBAAoBF,MACjD,EA/OA,EAAAnB,QAAAA,SAAE,iCAAiCsB,YAAY,aAC/C,EAAAtB,QAAAA,SAAE,iCAAiCsB,YAAY,aAC/C,EAAAtB,QAAAA,SAAE,mCAAmCsB,YAAY,eACjD,EAAAtB,QAAAA,SAAE,4BAA4BsB,YAAY,QAG1C,EAAAtB,QAACjB,SAACwC,UAAUC,GAAG,QAAS,cAAc,SAASC,GAC3CA,EAAEC,kBAEF,EAAA9B,yCAEAC,aAEAP,QAAS,CACb,KAGA,EAAAU,QAAAA,SAAE,YAAY2B,UAAS,SAASF,GACb,IAAXA,EAAEG,SACF,EAAA5B,QAAAA,SAAE6B,MAAMC,QAAQ,UAAUC,SAC1BN,EAAEC,iBAEV,KAGA,EAAA1B,QAAAA,SAAEuB,UAAUC,GAAG,UAAW,iBAAiB,WAGvC,GAAkD,KAF9BQ,OAAOC,eAAeC,WAAW,GAEnCC,gBAAgBC,aAAsBjD,mBAAoB,EAExE,EAAAS,yCAEAC,aAGAJ,cAsNZ,SAA0B4C,MACtB,MAAMC,OAAS,CAACN,OAAOC,eAAeC,WAAW,IAEjD,GAAII,OAAOC,UACP,OAAO,KAGX,MAAMC,eAAiBF,OAAOG,KAAIC,QAAS,EAAAC,wBAASN,KAAMK,SAOpDE,WAAa,CACjBC,OANaL,eAAeC,KAAIK,YAAc,CAC9CC,SAAUD,eAUZ,OAFA,EAAAE,cAAMA,QAACJ,WAAYP,MAEZO,UACX,CA3O4BK,CAAiBpB,MAEjC,IAAI9B,MAAQ8B,KAAKqB,GAAGC,QAAQ,SAAU,KAGtC,EAAAnD,QAAAA,SAAE,oBAAsBD,MAAQ,iCAAiCG,IAC7DT,cAAcoD,OAAO,GAAGE,SAAS,GAAGK,iBACxC,EAAApD,QAAAA,SAAE,oBAAsBD,MAAQ,+BAA+BG,IAC3DT,cAAcoD,OAAO,GAAGE,SAAS,GAAGM,eACxC,EAAArD,QAAAA,SAAE,oBAAsBD,MAAQ,8BAA8BG,IAC1DT,cAAcoD,OAAO,GAAGE,SAAS,GAAGO,cACxC,EAAAtD,QAAAA,SAAE,oBAAsBD,MAAQ,4BAA4BG,IACxDT,cAAcoD,OAAO,GAAGE,SAAS,GAAGQ,YAGxC,EAAAvD,QAAAA,SAAE,oBAAsBD,MAAQ,kCAAkCG,IAC9DT,cAAcoD,OAAO,GAAGE,SAAS,GAAGS,QACxC,EAAAxD,QAAAA,SAAE,oBAAsBD,MAAQ,gCAAgCG,IAC5DT,cAAcoD,OAAO,GAAGE,SAAS,GAAGU,MAGxC,EAAAzD,QAAAA,SAAE,oBAAsBD,MAAQ,wBAAwBG,IACpDT,cAAcoD,OAAO,GAAGE,SAAS,GAAGtC,QACxC,EAAAT,QAAAA,SAAE,oBAAsBD,MAAQ,yBAAyBG,IACrDT,cAAcoD,OAAO,GAAGE,SAAS,GAAGrC,SACxC,EAAAV,QAAAA,SAAE,oBAAsBD,MAAQ,yBAAyBG,IACrDT,cAAcoD,OAAO,GAAGE,SAAS,GAAGpC,SAExC,EAAAX,QAACjB,SAAC,oBAAsBgB,MAAQ,WAAWG,IAAI,IAG/C,EAAAF,iBAAE,2BAA6BD,OAAOe,KAClCrB,cAAcoD,OAAO,GAAGE,SAAS,GAAGtC,MAAMM,WAAW,IAAK,QAAQA,WAAW,IAAK,UAEtF,EAAAf,QAAAA,SAAE,mBAAqBD,MAAQ,qBAAqBoB,QACpD,EAAAnB,QAAAA,SAAE,oBAAsBD,MAAQ,aAAaqB,OACjD,CACJ,IAGApB,QAACjB,QAAC2E,KAAK,CACHC,IAAK,oBACLC,KAAM,CAACV,GAAMhE,KAAM2E,eAAkB,GACrCC,QAAS,SAASC,UACdxE,YAAcyE,KAAKC,MAAMF,UAoEjC,WAEI,IAAK,IAAInB,cAAcsB,OAAOC,OAAO5E,aAAc,CAE/C,MAaME,cAAgB,CAClBmD,WAAYA,WACZC,OAfmB,CAAC,CACpB,CAAChC,KAAM,gBAAiBuC,eAAgBR,WAAWzC,eAAgBmD,YAAac,SAASxB,WAAWvC,aACpGgD,aAAcT,WAAWxC,aAAcmD,UAAWa,SAASxB,WAAWtC,YACtE,CAACO,KAAM,uBAAwB2C,MAAOY,SAASxB,WAAWrC,iBAC1DkD,IAAKW,SAASxB,WAAWpC,gBACzB,CAACK,KAAM,oBAAqBJ,MAAOmC,WAAWnC,MAAOC,OAAQkC,WAAWlC,OAAQC,OAAQiC,WAAWjC,UAGzE8B,KAAIK,YAAc,CAC5CC,SAAUD,gBASd,EAAAE,sBAAOvD,eAAe,EAAAO,iBAAE,UAAY4C,WAAW7C,OAAO,GAC1D,CACJ,CA3FQsE,IAGA,EAAArE,iBAAE,cAAcsE,YAAW,WACvB,IAAIpB,GAAKrB,KAAKqB,GAAGC,QAAQ,aAAc,KACvC,EAAAnD,QAAAA,SAAE,mBAAqBkD,IAAIqB,SAAS,YACpC,EAAAvE,QAACjB,SAAC,cAAgBmE,IAAIlC,IAAI,mBAAoB,YAClD,KAEA,EAAAhB,iBAAE,cAAcwE,YAAW,WACvB,IAAItB,GAAKrB,KAAKqB,GAAGC,QAAQ,aAAc,KACvC,EAAAnD,QAAAA,SAAE,mBAAqBkD,IAAI5B,YAAY,YACvC,EAAAtB,QAAAA,SAAE,cAAgBkD,IAAIlC,IAAI,oBAAoB,EAAAhB,QAACjB,SAAC,cAAgBmE,IAAIlC,IAAI,uBAC5E,KAGA,EAAAhB,QAAAA,SAAEuB,UAAUC,GAAG,YAAa,mBAAmB,YAC3C,EAAAxB,QAAAA,SAAE,mBAAmBuE,SAAS,UAClC,KAEA,EAAAvE,QAAAA,SAAEuB,UAAUC,GAAG,aAAc,mBAAmB,YAC5C,EAAAxB,QAAAA,SAAE,mBAAmBsB,YAAY,UACrC,KAGA,EAAAtB,QAAAA,SAAEuB,UAAUC,GAAG,QAAS,cAAc,WAElC9B,eADSmC,KAAKqB,GAAGC,QAAQ,aAAc,IAE3C,KAGA,EAAAnD,QAAAA,SAAEuB,UAAUC,GAAG,QAAS,oBAAoB,WAExC9B,eADSmC,KAAKqB,GAAGC,QAAQ,mBAAoB,IAEjD,KAGA,EAAAnD,QAAAA,SAAEuB,UAAUC,GAAG,YAAa,oBAAoB,WAC5C,IAAI0B,GAAKrB,KAAKqB,GAAGC,QAAQ,mBAAoB,KAC7C,EAAAnD,QAACjB,SAAC,cAAgBmE,IAAIlC,IAAI,mBAAoB,YAClD,KAEA,EAAAhB,QAAAA,SAAEuB,UAAUC,GAAG,aAAc,oBAAoB,WAC7C,IAAI0B,GAAKrB,KAAKqB,GAAGC,QAAQ,mBAAoB,KAC7C,EAAAnD,QAAAA,SAAE,cAAgBkD,IAAIlC,IAAI,oBAAoB,EAAAhB,QAACjB,SAAC,cAAgBmE,IAAIlC,IAAI,uBAC5E,IAIuB,GAAnB3B,mBACA,EAAAW,QAACjB,SAAC,cAAgBM,iBAAiBoF,KAAK,YAAa,IACrD,EAAAzE,QAAAA,SAAE,cAAgBX,iBAAiB+B,QAG1C,EACDsD,SAAU,YACN,EAAA1E,iBAAE,YAAYC,MACjB,EACD0E,MAAO,WAEP,GAmGJ,CA+BH"}