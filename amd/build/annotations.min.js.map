{"version":3,"sources":["../src/annotations.js"],"names":["define","$","init","annotations","canmakeannotations","hide","removeClass","editAnnotation","annotationid","removeAllTempHighlights","resetForms","entry","console","log","type","val","startcontainer","endcontainer","startposition","endposition","text","show","focus","not","wholeTextNodesInRange","range","collapsed","root","commonAncestorContainer","nodeType","Node","ELEMENT_NODE","parentElement","textNodes","nodeIter","ownerDocument","createNodeIterator","NodeFilter","SHOW_TEXT","node","nextNode","isNodeInRange","startContainer","startOffset","splitText","endContainer","endOffset","data","length","push","highlightRange","cssClass","color","textNodeSpans","prevNode","currentSpan","forEach","nextSibling","filter","span","some","test","nodeValue","highlights","nodes","highlightEl","document","createElement","className","id","style","backgroundColor","parentNode","replaceChild","appendChild","childNodes","comparePoint","e","getNodeName","nodeName","toLowerCase","result","getNodePosition","pos","tmp","previousSibling","getPathSegment","name","xpathFromNode","xpath","elem","Error","replace","nthChildOfType","element","index","toUpperCase","matchIndex","i","child","children","evaluateSimpleXPath","isSimpleXPath","match","segments","split","shift","segment","elementName","elementIndex","separatorPos","indexOf","slice","indexStr","parseInt","nodeFromXPath","body","err","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","replaceWith","replacements","parent","r","insertBefore","remove","Array","from","querySelectorAll","removeHighlights","on","selectedrange","window","getSelection","getRangeAt","cloneContents","textContent","Object","values","annotation","newrange","createRange","setStart","setEnd","mouseenter","addClass","mouseleave","preventDefault"],"mappings":"mnCAwBCA,OAAM,0BAAC,CAAC,QAAD,CAAD,CAAa,SAASC,CAAT,CAAY,CAC5B,MAAO,CACHC,IAAI,CAAE,cAASC,CAAT,CAAsBC,CAAtB,CAA0C,CAG5CH,CAAC,CAAC,kBAAD,CAAD,CAAsBI,IAAtB,GAGAJ,CAAC,CAAC,+BAAD,CAAD,CAAmCK,WAAnC,CAA+C,UAA/C,EACAL,CAAC,CAAC,+BAAD,CAAD,CAAmCK,WAAnC,CAA+C,UAA/C,EACAL,CAAC,CAAC,iCAAD,CAAD,CAAqCK,WAArC,CAAiD,YAAjD,EACAL,CAAC,CAAC,0BAAD,CAAD,CAA8BK,WAA9B,CAA0C,KAA1C,EAwBA,QAASC,CAAAA,CAAT,CAAwBC,CAAxB,CAAsC,CAClC,GAAIJ,CAAJ,CAAwB,CACpBK,CAAuB,GACvBC,CAAU,GAKV,GAAIC,CAAAA,CAAK,CAAGR,CAAW,CAACK,CAAD,CAAX,CAA0BG,KAAtC,CAGAC,OAAO,CAACC,GAAR,CAAY,gCAAZ,EACAD,OAAO,CAACC,GAAR,CAAYV,CAAW,CAACK,CAAD,CAAX,CAA0BM,IAAtC,EACAF,OAAO,CAACC,GAAR,CAAY,KAAZ,EACAD,OAAO,CAACC,GAAR,CAAYZ,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,QAA/B,CAAb,EAEAV,CAAC,CAAC,mBAAqBO,CAAtB,CAAD,CAAqCH,IAArC,GAEAJ,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,iCAA/B,CAAD,CAAiEI,GAAjE,CAAqEZ,CAAW,CAACK,CAAD,CAAX,CAA0BQ,cAA/F,EACAf,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,+BAA/B,CAAD,CAA+DI,GAA/D,CAAmEZ,CAAW,CAACK,CAAD,CAAX,CAA0BS,YAA7F,EACAhB,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,gCAA/B,CAAD,CAAgEI,GAAhE,CAAoEZ,CAAW,CAACK,CAAD,CAAX,CAA0BU,aAA9F,EACAjB,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,8BAA/B,CAAD,CAA8DI,GAA9D,CAAkEZ,CAAW,CAACK,CAAD,CAAX,CAA0BW,WAA5F,EAEAlB,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,+BAA/B,CAAD,CAA+DI,GAA/D,CAAmEP,CAAnE,EAEAP,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,0BAA/B,CAAD,CAA0DI,GAA1D,CAA8DZ,CAAW,CAACK,CAAD,CAAX,CAA0BY,IAAxF,EAEAnB,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,SAA/B,CAAD,CAA2CI,GAA3C,CAA+CZ,CAAW,CAACK,CAAD,CAAX,CAA0BM,IAAzE,EAEAb,CAAC,CAAC,mBAAqBU,CAArB,CAA6B,mBAA9B,CAAD,CAAoDU,IAApD,GACApB,CAAC,CAAC,YAAcU,CAAf,CAAD,CAAuBW,KAAvB,EACH,CACJ,CAyBD,QAASZ,CAAAA,CAAT,EAAqB,CACjBT,CAAC,CAAC,kBAAD,CAAD,CAAsBI,IAAtB,GAEAJ,CAAC,CAAC,gDAAD,CAAD,CAAkDc,GAAlD,CAAsD,IAAtD,EAEAd,CAAC,CAAC,kDAAD,CAAD,CAAoDc,GAApD,CAAwD,CAAC,CAAzD,EACAd,CAAC,CAAC,gDAAD,CAAD,CAAkDc,GAAlD,CAAsD,CAAC,CAAvD,EACAd,CAAC,CAAC,iDAAD,CAAD,CAAmDc,GAAnD,CAAuD,CAAC,CAAxD,EACAd,CAAC,CAAC,+CAAD,CAAD,CAAiDc,GAAjD,CAAqD,CAAC,CAAtD,EAEAd,CAAC,CAAC,2CAAD,CAAD,CAA6Cc,GAA7C,CAAiD,EAAjD,EAEAd,CAAC,CAAC,iBAAD,CAAD,CAAqBsB,GAArB,CAAyB,kBAAzB,EAA6CF,IAA7C,EACH,CAWD,QAASG,CAAAA,CAAT,CAA+BC,CAA/B,CAAsC,CAClC,GAAIA,CAAK,CAACC,SAAV,CAAqB,CAIjB,MAAO,EACV,CAGD,GAAIC,CAAAA,CAAI,CAAGF,CAAK,CAACG,uBAAjB,CACA,GAAID,CAAI,CAACE,QAAL,GAAkBC,IAAI,CAACC,YAA3B,CAAyC,CAMrCJ,CAAI,CAAGA,CAAI,CAACK,aACf,CACD,GAAI,CAACL,CAAL,CAAW,CAGP,MAAO,EACV,CAtBiC,GAwB5BM,CAAAA,CAAS,CAAG,EAxBgB,CAyB5BC,CAAQ,CACdP,CAAI,CAACQ,aADoC,CAEvCC,kBAFuC,CAGzCT,CAHyC,CAIzCU,UAAU,CAACC,SAJ8B,CAzBP,CA+B9BC,CA/B8B,CAgClC,MAAQA,CAAI,CAAGL,CAAQ,CAACM,QAAT,EAAf,CAAqC,CACjC,GAAI,CAACC,CAAa,CAAChB,CAAD,CAAQc,CAAR,CAAlB,CAAiC,CAC7B,QACH,CACD,GAAInB,CAAAA,CAAI,CAAwBmB,CAAhC,CAEA,GAAInB,CAAI,GAAKK,CAAK,CAACiB,cAAf,EAAqD,CAApB,CAAAjB,CAAK,CAACkB,WAA3C,CAA4D,CAGxDvB,CAAI,CAACwB,SAAL,CAAenB,CAAK,CAACkB,WAArB,EACA,QACH,CAED,GAAIvB,CAAI,GAAKK,CAAK,CAACoB,YAAf,EAA+BpB,CAAK,CAACqB,SAAN,CAAkB1B,CAAI,CAAC2B,IAAL,CAAUC,MAA/D,CAAuE,CAEnE5B,CAAI,CAACwB,SAAL,CAAenB,CAAK,CAACqB,SAArB,CACH,CAEDb,CAAS,CAACgB,IAAV,CAAe7B,CAAf,CACH,CAED,MAAOa,CAAAA,CACV,CAUD,QAASiB,CAAAA,CAAT,CAAwBzB,CAAxB,CAA+F,IAAhEjB,CAAAA,CAAgE,2DAA1C2C,CAA0C,wDAA/B,WAA+B,CAAlBC,CAAkB,wDAAV,QAAU,CAErFnB,CAAS,CAAGT,CAAqB,CAACC,CAAD,CAFoD,CAMvF4B,CAAa,CAAG,EANuE,CAOvFC,CAAQ,CAAG,IAP4E,CAQvFC,CAAW,CAAG,IARyE,CAU3FtB,CAAS,CAACuB,OAAV,CAAkB,SAAAjB,CAAI,CAAI,CAC1B,GAAIe,CAAQ,EAAIA,CAAQ,CAACG,WAAT,GAAyBlB,CAAzC,CAA+C,CAC3CgB,CAAW,CAACN,IAAZ,CAAiBV,CAAjB,CACH,CAFD,IAEO,CACHgB,CAAW,CAAG,CAAChB,CAAD,CAAd,CACAc,CAAa,CAACJ,IAAd,CAAmBM,CAAnB,CACH,CACDD,CAAQ,CAAGf,CACV,CARD,EAcAc,CAAa,CAAGA,CAAa,CAACK,MAAd,CAAqB,SAAAC,CAAI,QAEzCA,CAAAA,CAAI,CAACC,IAAL,CAAU,SAAArB,CAAI,QAAI,CAHC,OAGA,CAAWsB,IAAX,CAAgBtB,CAAI,CAACuB,SAArB,CAAL,CAAd,CAFyC,CAAzB,CAAhB,CAMA,GAAMC,CAAAA,CAAU,CAAG,EAAnB,CACAV,CAAa,CAACG,OAAd,CAAsB,SAAAQ,CAAK,CAAI,CAK/B,GAAMC,CAAAA,CAAW,CAAGC,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CAApB,CACAF,CAAW,CAACG,SAAZ,CAAwBjB,CAAxB,CAEAvC,OAAO,CAACC,GAAR,CAAY,oDAAZ,EACAD,OAAO,CAACC,GAAR,CAAY,IAAMuC,CAAlB,EAEA,GAAI5C,CAAJ,CAAkB,CACdyD,CAAW,CAACG,SAAZ,EAAyB,IAAMjB,CAAN,CAAiB,GAAjB,CAAuB3C,CAAhD,CACAyD,CAAW,CAACI,EAAZ,CAAiBlB,CAAQ,CAAG,GAAX,CAAiB3C,CAAlC,CACAyD,CAAW,CAACK,KAAZ,CAAkBC,eAAlB,CAAoC,IAAMnB,CAC7C,CAEDY,CAAK,CAAC,CAAD,CAAL,CAASQ,UAAT,CAAoBC,YAApB,CAAiCR,CAAjC,CAA8CD,CAAK,CAAC,CAAD,CAAnD,EACAA,CAAK,CAACR,OAAN,CAAc,SAAAjB,CAAI,QAAI0B,CAAAA,CAAW,CAACS,WAAZ,CAAwBnC,CAAxB,CAAJ,CAAlB,EAEAwB,CAAU,CAACd,IAAX,CAAgBgB,CAAhB,CACC,CArBD,EAuBA,MAAOF,CAAAA,CACV,CAQD,QAAStB,CAAAA,CAAT,CAAuBhB,CAAvB,CAA8Bc,CAA9B,CAAoC,CAChC,GAAI,SACMS,CAAM,qBAAGT,CAAI,CAACuB,SAAR,qBAAG,EAAgBd,MAAnB,gBAA6BT,CAAI,CAACoC,UAAL,CAAgB3B,MADzD,CAEA,MAEmC,EAA/B,EAAAvB,CAAK,CAACmD,YAAN,CAAmBrC,CAAnB,CAAyB,CAAzB,GAEoC,CAApC,EAAAd,CAAK,CAACmD,YAAN,CAAmBrC,CAAnB,CAAyBS,CAAzB,CAEP,CAAC,MAAO6B,CAAP,CAAU,CAGZ,QACC,CACJ,CA2BD,QAASC,CAAAA,CAAT,CAAqBvC,CAArB,CAA2B,IACjBwC,CAAAA,CAAQ,CAAGxC,CAAI,CAACwC,QAAL,CAAcC,WAAd,EADM,CAEnBC,CAAM,CAAGF,CAFU,CAGvB,GAAiB,OAAb,GAAAA,CAAJ,CAA0B,CACtBE,CAAM,CAAG,QACZ,CACD,MAAOA,CAAAA,CACV,CAOD,QAASC,CAAAA,CAAT,CAAyB3C,CAAzB,CAA+B,IACvB4C,CAAAA,CAAG,CAAG,CADiB,CAGvBC,CAAG,CAAG7C,CAHiB,CAI3B,MAAO6C,CAAP,CAAY,CACR,GAAIA,CAAG,CAACL,QAAJ,GAAiBxC,CAAI,CAACwC,QAA1B,CAAoC,CAChCI,CAAG,EAAI,CACV,CACDC,CAAG,CAAGA,CAAG,CAACC,eACT,CACL,MAAOF,CAAAA,CACV,CAED,QAASG,CAAAA,CAAT,CAAwB/C,CAAxB,CAA8B,IACpBgD,CAAAA,CAAI,CAAGT,CAAW,CAACvC,CAAD,CADE,CAEpB4C,CAAG,CAAGD,CAAe,CAAC3C,CAAD,CAFD,CAG1B,gBAAUgD,CAAV,aAAkBJ,CAAlB,KACH,CASD,QAASK,CAAAA,CAAT,CAAuBjD,CAAvB,CAA6BZ,CAA7B,CAAmC,IAC3B8D,CAAAA,CAAK,CAAG,EADmB,CAI3BC,CAAI,CAAGnD,CAJoB,CAK/B,MAAOmD,CAAI,GAAK/D,CAAhB,CAAsB,CAClB,GAAI,CAAC+D,CAAL,CAAW,CACP,KAAM,IAAIC,CAAAA,KAAJ,CAAU,kCAAV,CACT,CACDF,CAAK,CAAGH,CAAc,CAACI,CAAD,CAAd,CAAuB,GAAvB,CAA6BD,CAArC,CACAC,CAAI,CAAGA,CAAI,CAAClB,UACf,CACDiB,CAAK,CAAG,IAAMA,CAAd,CACAA,CAAK,CAAGA,CAAK,CAACG,OAAN,CAAc,KAAd,CAAqB,EAArB,CAAR,CAEA,MAAOH,CAAAA,CACV,CAUD,QAASI,CAAAA,CAAT,CAAwBC,CAAxB,CAAiCf,CAAjC,CAA2CgB,CAA3C,CAAkD,CAC9ChB,CAAQ,CAAGA,CAAQ,CAACiB,WAAT,EAAX,CAGA,OADIC,CAAAA,CAAU,CAAG,CAAC,CAClB,CAASC,CAAC,CAAG,CAAb,CACMC,CADN,CAAgBD,CAAC,CAAGJ,CAAO,CAACM,QAAR,CAAiBpD,MAArC,CAA6CkD,CAAC,EAA9C,CAAkD,CAC5CC,CAD4C,CACpCL,CAAO,CAACM,QAAR,CAAiBF,CAAjB,CADoC,CAElD,GAAIC,CAAK,CAACpB,QAAN,CAAeiB,WAAf,KAAiCjB,CAArC,CAA+C,CAC3C,EAAEkB,CAAF,CACA,GAAIA,CAAU,GAAKF,CAAnB,CAA0B,CAC1B,MAAOI,CAAAA,CACN,CACJ,CACA,CAED,MAAO,KACV,CAuBD,QAASE,CAAAA,CAAT,CAA6BZ,CAA7B,CAAoC9D,CAApC,CAA0C,CACtC,GAAM2E,CAAAA,CAAa,CAAwD,IAArD,GAAAb,CAAK,CAACc,KAAN,CAAY,mCAAZ,CAAtB,CACA,GAAI,CAACD,CAAL,CAAoB,CAChB,KAAM,IAAIX,CAAAA,KAAJ,CAAU,kCAAV,CACT,CAJqC,GAMhCa,CAAAA,CAAQ,CAAGf,CAAK,CAACgB,KAAN,CAAY,GAAZ,CANqB,CAOlCX,CAAO,CAAGnE,CAPwB,CAWtC6E,CAAQ,CAACE,KAAT,GAXsC,iCAalBF,CAbkB,QAatC,2BAA8B,IAArBG,CAAAA,CAAqB,SACtBC,CAAW,OADW,CAEtBC,CAAY,OAFU,CAIpBC,CAAY,CAAGH,CAAO,CAACI,OAAR,CAAgB,GAAhB,CAJK,CAK1B,GAAqB,CAAC,CAAlB,GAAAD,CAAJ,CAAyB,CACrBF,CAAW,CAAGD,CAAO,CAACK,KAAR,CAAc,CAAd,CAAiBF,CAAjB,CAAd,CAEA,GAAMG,CAAAA,CAAQ,CAAGN,CAAO,CAACK,KAAR,CAAcF,CAAY,CAAG,CAA7B,CAAgCH,CAAO,CAACI,OAAR,CAAgB,GAAhB,CAAhC,CAAjB,CACAF,CAAY,CAAGK,QAAQ,CAACD,CAAD,CAAR,CAAqB,CAApC,CACA,GAAmB,CAAf,CAAAJ,CAAJ,CAAsB,CACtB,MAAO,KACN,CACJ,CARD,IAQO,CACHD,CAAW,CAAGD,CAAd,CACAE,CAAY,CAAG,CAClB,CAED,GAAMV,CAAAA,CAAK,CAAGN,CAAc,CAACC,CAAD,CAAUc,CAAV,CAAuBC,CAAvB,CAA5B,CACA,GAAI,CAACV,CAAL,CAAY,CACR,MAAO,KACV,CAEDL,CAAO,CAAGK,CACb,CArCqC,+BAuCtC,MAAOL,CAAAA,CACV,CAYD,QAASqB,CAAAA,CAAT,CAAuB1B,CAAvB,CAAoD,IAAtB9D,CAAAA,CAAsB,wDAAfuC,QAAQ,CAACkD,IAAM,CAChD,GAAI,CACA,MAAOf,CAAAA,CAAmB,CAACZ,CAAD,CAAQ9D,CAAR,CAC7B,CAAC,MAAO0F,CAAP,CAAY,CACV,MAAOnD,CAAAA,QAAQ,CAACoD,QAAT,CACH,IAAM7B,CADH,CAEH9D,CAFG,CAMH,IANG,CAOH4F,WAAW,CAACC,uBAPT,CAQH,IARG,EASLC,eACL,CACJ,CAUD,QAASC,CAAAA,CAAT,CAAqBnF,CAArB,CAA2BoF,CAA3B,CAAyC,CACrC,GAAMC,CAAAA,CAAM,CAAwBrF,CAAI,CAACiC,UAAzC,CAEAmD,CAAY,CAACnE,OAAb,CAAqB,SAAAqE,CAAC,QAAID,CAAAA,CAAM,CAACE,YAAP,CAAoBD,CAApB,CAAuBtF,CAAvB,CAAJ,CAAtB,EACAA,CAAI,CAACwF,MAAL,EACH,CAOD,QAAStH,CAAAA,CAAT,EAAmC,CAC/B,GAAMsD,CAAAA,CAAU,CAAGiE,KAAK,CAACC,IAAN,CAAWhI,CAAC,CAAC,MAAD,CAAD,CAAU,CAAV,EAAaiI,gBAAb,CAA8B,iBAA9B,CAAX,CAAnB,CACA,GAAInE,CAAU,SAAV,EAAiD,CAArB,EAAAA,CAAU,CAACf,MAA3C,CAAuD,CACnDmF,CAAgB,CAACpE,CAAD,CACnB,CACJ,CAOD,QAASoE,CAAAA,CAAT,CAA0BpE,CAA1B,CAAsC,CAClC,IAAK,GAAImC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGnC,CAAU,CAACf,MAA/B,CAAuCkD,CAAC,EAAxC,CAA4C,CACxC,GAAInC,CAAU,CAACmC,CAAD,CAAV,CAAc1B,UAAlB,CAA8B,CAC1B,GAAM4B,CAAAA,CAAQ,CAAG4B,KAAK,CAACC,IAAN,CAAWlE,CAAU,CAACmC,CAAD,CAAV,CAAcvB,UAAzB,CAAjB,CACA+C,CAAW,CAAC3D,CAAU,CAACmC,CAAD,CAAX,CAAgBE,CAAhB,CACd,CACJ,CACJ,CAIDnG,CAAC,CAACiE,QAAD,CAAD,CAAYkE,EAAZ,CAAe,SAAf,CAA0B,eAA1B,CAA2C,UAAW,CAClD,GAAIC,CAAAA,CAAa,CAAGC,MAAM,CAACC,YAAP,GAAsBC,UAAtB,CAAiC,CAAjC,CAApB,CASA,GAAkD,EAA9C,GAAAH,CAAa,CAACI,aAAd,GAA8BC,WAA9B,EAAoDtI,CAAxD,CAA4E,CACxEK,CAAuB,GAEvBC,CAAU,GAOV,GAAIC,CAAAA,CAAK,CAAG,KAAK0D,EAAL,CAAQuB,OAAR,CAAgB,QAAhB,CAA0B,EAA1B,CAAZ,CAQA3F,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,iCAA/B,CAAD,CAAiEI,GAAjE,CAAqEyE,CAAa,CAAC6C,CAAa,CAAC3F,cAAf,CAA+B,IAA/B,CAAlF,EACAzC,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,+BAA/B,CAAD,CAA+DI,GAA/D,CAAmEyE,CAAa,CAAC6C,CAAa,CAACxF,YAAf,CAA6B,IAA7B,CAAhF,EACA5C,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,gCAA/B,CAAD,CAAgEI,GAAhE,CAAoEsH,CAAa,CAAC1F,WAAlF,EACA1C,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,8BAA/B,CAAD,CAA8DI,GAA9D,CAAkEsH,CAAa,CAACvF,SAAhF,EAEA7C,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,SAA/B,CAAD,CAA2CI,GAA3C,CAA+C,CAA/C,EAEAmC,CAAc,CAACmF,CAAD,IAAuB,gBAAvB,CAAd,CAEApI,CAAC,CAAC,mBAAqBU,CAArB,CAA6B,mBAA9B,CAAD,CAAoDU,IAApD,GACApB,CAAC,CAAC,oBAAsBU,CAAtB,CAA8B,WAA/B,CAAD,CAA6CW,KAA7C,EACH,CACJ,CAxCD,EA0CA,CAjhBA,UAA8B,CAC1B,cAAuBqH,MAAM,CAACC,MAAP,CAAczI,CAAd,CAAvB,gBAAmD,IAA1C0I,CAAAA,CAAU,KAAgC,CAG3CC,CAAQ,CAAG5E,QAAQ,CAAC6E,WAAT,EAHgC,CAK/C,GAAI,CACAD,CAAQ,CAACE,QAAT,CAAkB7B,CAAa,CAAC0B,CAAU,CAAC7H,cAAZ,CAA4Bf,CAAC,CAAE,UAAY4I,CAAU,CAAClI,KAAzB,CAAD,CAAiC,CAAjC,CAA5B,CAA/B,CAAiGkI,CAAU,CAAC3H,aAA5G,EACA4H,CAAQ,CAACG,MAAT,CAAgB9B,CAAa,CAAC0B,CAAU,CAAC5H,YAAZ,CAA0BhB,CAAC,CAAE,UAAY4I,CAAU,CAAClI,KAAzB,CAAD,CAAiC,CAAjC,CAA1B,CAA7B,CAA6FkI,CAAU,CAAC1H,WAAxG,CACF,CACD,MAAO0D,CAAP,CAAU,CAGT,CAIF3B,CAAc,CAAC4F,CAAD,CAAWD,CAAU,CAACxE,EAAtB,CAA0B,WAA1B,CAAuCwE,CAAU,CAACzF,KAAlD,CAEjB,CACJ,CA6fD,IAGAnD,CAAC,CAAC,YAAD,CAAD,CAAgBiJ,UAAhB,CAA4B,UAAW,CACnC,GAAI7E,CAAAA,CAAE,CAAG,KAAKA,EAAL,CAAQuB,OAAR,CAAgB,YAAhB,CAA8B,EAA9B,CAAT,CACA3F,CAAC,CAAC,eAAeoE,CAAhB,CAAD,CAAqB8E,QAArB,CAA8B,SAA9B,EACAlJ,CAAC,CAAC,cAAcoE,CAAf,CAAD,CAAoB8E,QAApB,CAA6B,SAA7B,CACH,CAJD,EAMAlJ,CAAC,CAAC,YAAD,CAAD,CAAgBmJ,UAAhB,CAA4B,UAAW,CACnC,GAAI/E,CAAAA,CAAE,CAAG,KAAKA,EAAL,CAAQuB,OAAR,CAAgB,YAAhB,CAA8B,EAA9B,CAAT,CACA3F,CAAC,CAAC,eAAeoE,CAAhB,CAAD,CAAqB/D,WAArB,CAAiC,SAAjC,EACAL,CAAC,CAAC,cAAcoE,CAAf,CAAD,CAAoB/D,WAApB,CAAgC,SAAhC,CACH,CAJD,EAOAL,CAAC,CAAC,aAAD,CAAD,CAAiBiJ,UAAjB,CAA6B,UAAW,CACpC,GAAI7E,CAAAA,CAAE,CAAG,KAAKA,EAAL,CAAQuB,OAAR,CAAgB,aAAhB,CAA+B,EAA/B,CAAT,CACA3F,CAAC,CAAC,cAAcoE,CAAf,CAAD,CAAoB8E,QAApB,CAA6B,SAA7B,CACH,CAHD,EAKAlJ,CAAC,CAAC,aAAD,CAAD,CAAiBmJ,UAAjB,CAA6B,UAAW,CACpC,GAAI/E,CAAAA,CAAE,CAAG,KAAKA,EAAL,CAAQuB,OAAR,CAAgB,aAAhB,CAA+B,EAA/B,CAAT,CACA3F,CAAC,CAAC,cAAcoE,CAAf,CAAD,CAAoB/D,WAApB,CAAgC,SAAhC,CACH,CAHD,EAMAL,CAAC,CAACiE,QAAD,CAAD,CAAYkE,EAAZ,CAAe,WAAf,CAA4B,iBAA5B,CAA+C,UAAU,CACrDnI,CAAC,CAAC,iBAAD,CAAD,CAAqBkJ,QAArB,CAA8B,SAA9B,CACH,CAFD,EAIAlJ,CAAC,CAACiE,QAAD,CAAD,CAAYkE,EAAZ,CAAe,YAAf,CAA6B,iBAA7B,CAAgD,UAAU,CACtDnI,CAAC,CAAC,iBAAD,CAAD,CAAqBK,WAArB,CAAiC,SAAjC,CACH,CAFD,EAKAL,CAAC,CAACiE,QAAD,CAAD,CAAYkE,EAAZ,CAAe,OAAf,CAAwB,YAAxB,CAAsC,UAAU,CAG5C,GAAI/D,CAAAA,CAAE,CAAG,KAAKA,EAAL,CAAQuB,OAAR,CAAgB,YAAhB,CAA8B,EAA9B,CAAT,CACArF,CAAc,CAAC8D,CAAD,CACjB,CALD,EAQApE,CAAC,CAACiE,QAAD,CAAD,CAAYkE,EAAZ,CAAe,OAAf,CAAwB,kBAAxB,CAA4C,UAAU,CAGlD,GAAI/D,CAAAA,CAAE,CAAG,KAAKA,EAAL,CAAQuB,OAAR,CAAgB,kBAAhB,CAAoC,EAApC,CAAT,CACArF,CAAc,CAAC8D,CAAD,CACjB,CALD,EAgBApE,CAAC,CAACiE,QAAD,CAAD,CAAYkE,EAAZ,CAAe,OAAf,CAAwB,YAAxB,CAAsC,SAASvD,CAAT,CAAW,CAC7CA,CAAC,CAACwE,cAAF,GAKA5I,CAAuB,GAEvBC,CAAU,EACb,CATD,CAWH,CApmBE,CAsmBV,CAvmBM,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Module for the annotation functions of the margic.\n *\n * @module     mod_margic/annotations\n * @package    mod_margic\n * @copyright  2021 coactum GmbH\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n define(['jquery'], function($) {\n    return {\n        init: function(annotations, canmakeannotations) {\n\n            // Hide all Moodle forms\n            $('.annotation-form').hide();\n\n            // remove col-mds from moodle form\n            $('.annotation-form div.col-md-3').removeClass('col-md-3');\n            $('.annotation-form div.col-md-9').removeClass('col-md-9');\n            $('.annotation-form div.form-group').removeClass('form-group');\n            $('.annotation-form div.row').removeClass('row');\n\n            function recreateAnnotations(){\n                for (let annotation of Object.values(annotations)) {\n\n                    //recreate range from db\n                    var newrange = document.createRange();\n\n                    try {\n                        newrange.setStart(nodeFromXPath(annotation.startcontainer, $( \"#entry-\" + annotation.entry)[0]), annotation.startposition);\n                        newrange.setEnd(nodeFromXPath(annotation.endcontainer, $( \"#entry-\" + annotation.entry)[0]), annotation.endposition);\n                     }\n                     catch (e) {\n                        //console.log('try/catch');\n                        //console.log(e);\n                     }\n\n                    //console.log('recreateAnnotations after setStart/End');\n\n                    highlightRange(newrange, annotation.id, 'annotated', annotation.color);\n\n                }\n            }\n\n            function editAnnotation(annotationid) {\n                if (canmakeannotations) {\n                    removeAllTempHighlights();\n                    resetForms();\n\n                    //console.log('annotations from js');\n                    //console.log(annotations);\n\n                    var entry = annotations[annotationid].entry;\n\n                    //console.log(entry);\n                    console.log('i should set select default to');\n                    console.log(annotations[annotationid].type);\n                    console.log('for');\n                    console.log($('.annotation-form-' + entry + 'select'));\n\n                    $('.annotation-box-' + annotationid).hide(); // hide edited annotation-box\n\n                    $('.annotation-form-' + entry + ' input[name=\"startcontainer\"]').val(annotations[annotationid].startcontainer);\n                    $('.annotation-form-' + entry + ' input[name=\"endcontainer\"]').val(annotations[annotationid].endcontainer);\n                    $('.annotation-form-' + entry + ' input[name=\"startposition\"]').val(annotations[annotationid].startposition);\n                    $('.annotation-form-' + entry + ' input[name=\"endposition\"]').val(annotations[annotationid].endposition);\n\n                    $('.annotation-form-' + entry + ' input[name=\"annotationid\"]').val(annotationid);\n\n                    $('.annotation-form-' + entry + ' textarea[name=\"text\"]').val(annotations[annotationid].text);\n\n                    $('.annotation-form-' + entry + ' select').val(annotations[annotationid].type);\n\n                    $('.annotationarea-' + entry + ' .annotation-form').show();\n                    $('#id_text_' + entry).focus();\n                }\n            }\n\n            // function deleteAnnotation(annotationid) { // for later with ajax use\n\n            //     //console.log('delete annotation');\n            //     //console.log(annotationid);\n\n            //     // removeAllTempHighlights();\n            //     // resetForms();\n\n            //     // var entry = annotations[annotationid].entry;\n\n            //     // console.log(entry);\n\n            //     // $('input[name=\"startcontainer[' + entry + ']\"]').val(annotations[annotationid].startcontainer);\n            //     // $('input[name=\"endcontainer[' + entry + ']\"]').val(annotations[annotationid].endcontainer);\n            //     // $('input[name=\"startposition[' + entry + ']\"]').val(annotations[annotationid].startposition);\n            //     // $('input[name=\"endposition[' + entry + ']\"]').val(annotations[annotationid].endposition);\n\n            //     // $('textarea[name=\"text[' + entry + ']\"]').val(annotations[annotationid].text);\n\n            //     // $('.annotationarea-' + entry + ' .annotation-form').show();\n            //     // $('#id_text_' + entry).focus();\n            // }\n\n            function resetForms(){\n                $('.annotation-form').hide();\n\n                $('.annotation-form input[name^=\"annotationid\"]').val(null);\n\n                $('.annotation-form input[name^=\"startcontainer\"]').val(-1);\n                $('.annotation-form input[name^=\"endcontainer\"]').val(-1);\n                $('.annotation-form input[name^=\"startposition\"]').val(-1);\n                $('.annotation-form input[name^=\"endposition\"]').val(-1);\n\n                $('.annotation-form textarea[name^=\"text\"]').val('');\n\n                $('.annotation-box').not('.annotation-form').show(); // To show again edited annotation\n            }\n\n            /**\n             * Return text nodes which are entirely inside `range`.\n             *\n             * If a range starts or ends part-way through a text node, the node is split\n             * and the part inside the range is returned.\n             *\n             * @param {Range} range\n             * @return {Text[]}\n             */\n            function wholeTextNodesInRange(range) {\n                if (range.collapsed) {\n                    // Exit early for an empty range to avoid an edge case that breaks the algorithm\n                    // below. Splitting a text node at the start of an empty range can leave the\n                    // range ending in the left part rather than the right part.\n                    return [];\n                }\n\n                /** @type {Node|null} */\n                let root = range.commonAncestorContainer;\n                if (root.nodeType !== Node.ELEMENT_NODE) {\n                    // If the common ancestor is not an element, set it to the parent element to\n                    // ensure that the loop below visits any text nodes generated by splitting\n                    // the common ancestor.\n                    //\n                    // Note that `parentElement` may be `null`.\n                    root = root.parentElement;\n                }\n                if (!root) {\n                    // If there is no root element then we won't be able to insert highlights,\n                    // so exit here.\n                    return [];\n                }\n\n                const textNodes = [];\n                const nodeIter = /** @type {Document} */ (\n                root.ownerDocument\n                ).createNodeIterator(\n                root,\n                NodeFilter.SHOW_TEXT // Only return `Text` nodes.\n                );\n                let node;\n                while ((node = nodeIter.nextNode())) {\n                    if (!isNodeInRange(range, node)) {\n                        continue;\n                    }\n                    let text = /** @type {Text} */ (node);\n\n                    if (text === range.startContainer && range.startOffset > 0) {\n                        // Split `text` where the range starts. The split will create a new `Text`\n                        // node which will be in the range and will be visited in the next loop iteration.\n                        text.splitText(range.startOffset);\n                        continue;\n                    }\n\n                    if (text === range.endContainer && range.endOffset < text.data.length) {\n                        // Split `text` where the range ends, leaving it as the part in the range.\n                        text.splitText(range.endOffset);\n                    }\n\n                    textNodes.push(text);\n                }\n\n                return textNodes;\n            }\n\n            /**\n             * Wraps the DOM Nodes within the provided range with a highlight\n             * element of the specified class and returns the highlight Elements.\n             *\n             * @param {Range} range - Range to be highlighted\n             * @param {string} cssClass - A CSS class to use for the highlight\n             * @return {HighlightElement[]} - Elements wrapping text in `normedRange` to add a highlight effect\n             */\n            function highlightRange(range, annotationid = false, cssClass = 'annotated', color = 'FFFF00') {\n\n                const textNodes = wholeTextNodesInRange(range);\n\n                // Group text nodes into spans of adjacent nodes. If a group of text nodes are\n                // adjacent, we only need to create one highlight element for the group.\n                let textNodeSpans = [];\n                let prevNode = null;\n                let currentSpan = null;\n\n                textNodes.forEach(node => {\n                if (prevNode && prevNode.nextSibling === node) {\n                    currentSpan.push(node);\n                } else {\n                    currentSpan = [node];\n                    textNodeSpans.push(currentSpan);\n                }\n                prevNode = node;\n                });\n\n                // Filter out text node spans that consist only of white space. This avoids\n                // inserting highlight elements in places that can only contain a restricted\n                // subset of nodes such as table rows and lists.\n                const whitespace = /^\\s*$/;\n                textNodeSpans = textNodeSpans.filter(span =>\n                // Check for at least one text node with non-space content.\n                span.some(node => !whitespace.test(node.nodeValue))\n                );\n\n                // Wrap each text node span with a `<hypothesis-highlight>` element.\n                const highlights = [];\n                textNodeSpans.forEach(nodes => {\n                // A custom element name is used here rather than `<span>` to reduce the\n                // likelihood of highlights being hidden by page styling.\n\n                /** @type {HighlightElement} */\n                const highlightEl = document.createElement('span');\n                highlightEl.className = cssClass;\n\n                console.log('i should set background color of annotated text to');\n                console.log('#' + color);\n\n                if (annotationid) {\n                    highlightEl.className += ' ' + cssClass + '-' + annotationid;\n                    highlightEl.id = cssClass + '-' + annotationid;\n                    highlightEl.style.backgroundColor = '#' + color;\n                }\n\n                nodes[0].parentNode.replaceChild(highlightEl, nodes[0]);\n                nodes.forEach(node => highlightEl.appendChild(node));\n\n                highlights.push(highlightEl);\n                });\n\n                return highlights;\n            }\n\n            /**\n             * Returns true if any part of `node` lies within `range`.\n             *\n             * @param {Range} range\n             * @param {Node} node\n             */\n            function isNodeInRange(range, node) {\n                try {\n                    const length = node.nodeValue?.length ?? node.childNodes.length;\n                    return (\n                        // Check start of node is before end of range.\n                        range.comparePoint(node, 0) <= 0 &&\n                        // Check end of node is after start of range.\n                        range.comparePoint(node, length) >= 0\n                    );\n                } catch (e) {\n                    // `comparePoint` may fail if the `range` and `node` do not share a common\n                    // ancestor or `node` is a doctype.\n                return false;\n                }\n            }\n\n            /**\n             * CSS selector that will match the placeholder within a page/tile container.\n             */\n            //const placeholderSelector = '.annotator-placeholder';\n\n            /**\n             * Return true if `node` is inside a placeholder element created with `createPlaceholder`.\n             *\n             * This is typically used to test if a highlight element associated with an\n             * anchor is inside a placeholder.\n             *\n             * @param {Node} node\n             */\n            // function isInPlaceholder(node) {\n            //     if (!node.parentElement) {\n            //         return false;\n            //     }\n            //     return node.parentElement.closest(placeholderSelector) !== null;\n            // }\n\n            /**\n             * Get the node name for use in generating an xpath expression.\n             *\n             * @param {Node} node\n             */\n            function getNodeName(node) {\n                const nodeName = node.nodeName.toLowerCase();\n                let result = nodeName;\n                if (nodeName === '#text') {\n                    result = 'text()';\n                }\n                return result;\n            }\n\n            /**\n             * Get the index of the node as it appears in its parent's child list\n             *\n             * @param {Node} node\n             */\n            function getNodePosition(node) {\n                let pos = 0;\n                /** @type {Node|null} */\n                let tmp = node;\n                while (tmp) {\n                    if (tmp.nodeName === node.nodeName) {\n                        pos += 1;\n                    }\n                    tmp = tmp.previousSibling;\n                    }\n                return pos;\n            }\n\n            function getPathSegment(node) {\n                const name = getNodeName(node);\n                const pos = getNodePosition(node);\n                return `${name}[${pos}]`;\n            }\n\n            /**\n             * A simple XPath generator which can generate XPaths of the form\n             * /tag[index]/tag[index].\n             *\n             * @param {Node} node - The node to generate a path to\n             * @param {Node} root - Root node to which the returned path is relative\n             */\n            function xpathFromNode(node, root) {\n                let xpath = '';\n\n                /** @type {Node|null} */\n                let elem = node;\n                while (elem !== root) {\n                    if (!elem) {\n                        throw new Error('Node is not a descendant of root');\n                    }\n                    xpath = getPathSegment(elem) + '/' + xpath;\n                    elem = elem.parentNode;\n                }\n                xpath = '/' + xpath;\n                xpath = xpath.replace(/\\/$/, ''); // Remove trailing slash\n\n                return xpath;\n            }\n\n            /**\n             * Return the `index`'th immediate child of `element` whose tag name is\n             * `nodeName` (case insensitive).\n             *\n             * @param {Element} element\n             * @param {string} nodeName\n             * @param {number} index\n             */\n            function nthChildOfType(element, nodeName, index) {\n                nodeName = nodeName.toUpperCase();\n\n                let matchIndex = -1;\n                for (let i = 0; i < element.children.length; i++) {\n                const child = element.children[i];\n                if (child.nodeName.toUpperCase() === nodeName) {\n                    ++matchIndex;\n                    if (matchIndex === index) {\n                    return child;\n                    }\n                }\n                }\n\n                return null;\n            }\n\n            /**\n             * Evaluate a _simple XPath_ relative to a `root` element and return the\n             * matching element.\n             *\n             * A _simple XPath_ is a sequence of one or more `/tagName[index]` strings.\n             *\n             * Unlike `document.evaluate` this function:\n             *\n             *  - Only supports simple XPaths\n             *  - Is not affected by the document's _type_ (HTML or XML/XHTML)\n             *  - Ignores element namespaces when matching element names in the XPath against\n             *    elements in the DOM tree\n             *  - Is case insensitive for all elements, not just HTML elements\n             *\n             * The matching element is returned or `null` if no such element is found.\n             * An error is thrown if `xpath` is not a simple XPath.\n             *\n             * @param {string} xpath\n             * @param {Element} root\n             * @return {Element|null}\n             */\n            function evaluateSimpleXPath(xpath, root) {\n                const isSimpleXPath = xpath.match(/^(\\/[A-Za-z0-9-]+(\\[[0-9]+\\])?)+$/) !== null;\n                if (!isSimpleXPath) {\n                    throw new Error('Expression is not a simple XPath');\n                }\n\n                const segments = xpath.split('/');\n                let element = root;\n\n                // Remove leading empty segment. The regex above validates that the XPath\n                // has at least two segments, with the first being empty and the others non-empty.\n                segments.shift();\n\n                for (let segment of segments) {\n                    let elementName;\n                    let elementIndex;\n\n                    const separatorPos = segment.indexOf('[');\n                    if (separatorPos !== -1) {\n                        elementName = segment.slice(0, separatorPos);\n\n                        const indexStr = segment.slice(separatorPos + 1, segment.indexOf(']'));\n                        elementIndex = parseInt(indexStr) - 1;\n                        if (elementIndex < 0) {\n                        return null;\n                        }\n                    } else {\n                        elementName = segment;\n                        elementIndex = 0;\n                    }\n\n                    const child = nthChildOfType(element, elementName, elementIndex);\n                    if (!child) {\n                        return null;\n                    }\n\n                    element = child;\n                }\n\n                return element;\n            }\n\n            /**\n             * Finds an element node using an XPath relative to `root`\n             *\n             * Example:\n             *   node = nodeFromXPath('/main/article[1]/p[3]', document.body)\n             *\n             * @param {string} xpath\n             * @param {Element} [root]\n             * @return {Node|null}\n             */\n            function nodeFromXPath(xpath, root = document.body) {\n                try {\n                    return evaluateSimpleXPath(xpath, root);\n                } catch (err) {\n                    return document.evaluate(\n                        '.' + xpath,\n                        root,\n\n                        // nb. The `namespaceResolver` and `result` arguments are optional in the spec\n                        // but required in Edge Legacy.\n                        null /* namespaceResolver */,\n                        XPathResult.FIRST_ORDERED_NODE_TYPE,\n                        null /* result */\n                    ).singleNodeValue;\n                }\n            }\n\n            /**\n             * Replace a child `node` with `replacements`.\n             *\n             * nb. This is like `ChildNode.replaceWith` but it works in older browsers.\n             *\n             * @param {ChildNode} node\n             * @param {Node[]} replacements\n             */\n            function replaceWith(node, replacements) {\n                const parent = /** @type {Node} */ (node.parentNode);\n\n                replacements.forEach(r => parent.insertBefore(r, node));\n                node.remove();\n            }\n\n            /**\n             * Remove all temporary highlights under a given root element.\n             *\n             * @param {HTMLElement} root\n             */\n            function removeAllTempHighlights() {\n                const highlights = Array.from($('body')[0].querySelectorAll('.annotated_temp'));\n                if (highlights !== undefined && highlights.length != 0){\n                    removeHighlights(highlights);\n                }\n            }\n\n            /**\n             * Remove highlights from a range previously highlighted with `highlightRange`.\n             *\n             * @param {HighlightElement[]} highlights - The highlight elements returned by `highlightRange`\n             */\n            function removeHighlights(highlights) {\n                for (var i = 0; i < highlights.length; i++) {\n                    if (highlights[i].parentNode) {\n                        const children = Array.from(highlights[i].childNodes);\n                        replaceWith(highlights[i], children);\n                    }\n                }\n            }\n\n\n            // If user selects text for new annotation\n            $(document).on('mouseup', '.originaltext', function() {\n                var selectedrange = window.getSelection().getRangeAt(0);\n\n                // console.log('i should make annotation');\n\n                // console.log('window.getSelection()');\n                // console.log(window.getSelection());\n                // console.log('selectedrange');\n                // console.log(selectedrange);\n\n                if (selectedrange.cloneContents().textContent !== '' && canmakeannotations) {\n                    removeAllTempHighlights(); // remove other temporary highlights\n\n                    resetForms(); // remove old form contents\n\n                    //console.log('i should make concrete annotation');\n\n                    // console.log(addertoolbar);\n                    // console.log(addertoolbar.buildAdderToolbar());\n\n                    var entry = this.id.replace(/entry-/, '');\n\n                    //getSelectionValues(entry);\n\n                    //createAnnotation(entry);\n                    //console.log('selectedrange.cloneContents().textContent');\n                    //console.log(selectedrange.cloneContents().textContent);\n\n                    $('.annotation-form-' + entry + ' input[name=\"startcontainer\"]').val(xpathFromNode(selectedrange.startContainer, this));\n                    $('.annotation-form-' + entry + ' input[name=\"endcontainer\"]').val(xpathFromNode(selectedrange.endContainer, this));\n                    $('.annotation-form-' + entry + ' input[name=\"startposition\"]').val(selectedrange.startOffset);\n                    $('.annotation-form-' + entry + ' input[name=\"endposition\"]').val(selectedrange.endOffset);\n\n                    $('.annotation-form-' + entry + ' select').val(1);\n\n                    highlightRange(selectedrange, false, 'annotated_temp');\n\n                    $('.annotationarea-' + entry + ' .annotation-form').show();\n                    $('.annotation-form-' + entry + ' #id_text').focus();\n                }\n            });\n\n            recreateAnnotations();\n\n            // Highlight annotation and all annotated text if annotated text is hovered\n            $('.annotated').mouseenter (function() {\n                var id = this.id.replace('annotated-', '');\n                $('.annotation-'+id).addClass('hovered');\n                $('.annotated-'+id).addClass('hovered');\n            });\n\n            $('.annotated').mouseleave (function() {\n                var id = this.id.replace('annotated-', '');\n                $('.annotation-'+id).removeClass('hovered');\n                $('.annotated-'+id).removeClass('hovered');\n            });\n\n            // Highlight annotated text if annotation is hovered\n            $('.annotation').mouseenter (function() {\n                var id = this.id.replace('annotation-', '');\n                $('.annotated-'+id).addClass('hovered');\n            });\n\n            $('.annotation').mouseleave (function() {\n                var id = this.id.replace('annotation-', '');\n                $('.annotated-'+id).removeClass('hovered');\n            });\n\n            // Highlight whole temp annotation if part of temp annotation is hovered\n            $(document).on('mouseover', '.annotated_temp', function(){\n                $('.annotated_temp').addClass('hovered');\n            });\n\n            $(document).on('mouseleave', '.annotated_temp', function(){\n                $('.annotated_temp').removeClass('hovered');\n            });\n\n            // onclick listener for editing annotation\n            $(document).on('click', '.annotated', function(){\n                //console.log('annotated text is clicked');\n                //console.log(this);\n                var id = this.id.replace('annotated-', '');\n                editAnnotation(id);\n            });\n\n            // onclick listener for editing annotation\n            $(document).on('click', '.edit-annotation', function(){\n                //console.log('edit annotation button clicked');\n                //console.log(this);\n                var id = this.id.replace('edit-annotation-', '');\n                editAnnotation(id);\n            });\n\n            // onclick listener for deleting annotation\n            // $(document).on('click', '.delete-annotation', function(){\n            //     //console.log('delete annotation button clicked');\n            //     //console.log(this);\n            //     var id = this.id.replace('delete-annotation-', '');\n            //     deleteAnnotation(id);\n            // });\n\n            // onclick listener if form is canceled\n            $(document).on('click', '#id_cancel', function(e){\n                e.preventDefault();\n\n                //console.log('form is canceled');\n                //console.log(e);\n\n                removeAllTempHighlights(); // remove other temporary highlights\n\n                resetForms(); // remove old form contents\n            });\n\n        }\n    };\n});"],"file":"annotations.min.js"}