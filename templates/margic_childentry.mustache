{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @copyright   2022 coactum GmbH
    @template margic/margic_childentry

    Template for single child entry.
}}

{{#js}}
{{/js}}

<div class="childentrywrapper">
    <div class="d-flex justify-content-between">
        <div class="entry {{^annotationmode}}w-100{{/annotationmode}}" style="background: {{entrybgc}}; {{#annotationmode}}width: {{entryareawidth}}% {{/annotationmode}} ">
            <h5>{{#str}}revision, mod_margic{{/str}} {{revision}} ({{#userdate}}{{timecreated}}, {{#str}} strftimedaydatetime, core_langconfig {{/str}}{{/userdate}})
            </h5>

            {{#text}}
                <div id="entry-{{id}}" class="entry originaltext" style="background: {{entrytextbgc}};">
                    {{{text}}}
                </div>
            {{/text}}
            {{^text}}<p class="text-center"><strong>{{#str}}blankentry, mod_margic{{/str}}</strong></p>{{/text}}
        </div>
        {{#annotationmode}}
            <div class="annotationarea annotationarea-{{id}}" style="background: {{entrybgc}}; width: {{annotationareawidth}}%">
                {{#annotations}}
                    <div id="annotation-box-{{id}}" class="annotation-box annotation-box-{{id}}" style="background: {{entrytextbgc}};" tabindex="{{position}}">
                        <div class="errortypeheader">
                            <span style="border-left: 10px solid #{{color}}; padding-left: 5px;"> </span>
                            <strong class="errortype">{{type}}</strong>
                            <button class="btn btn-secondary margic-btn-round-small pull-right" data-toggle="collapse" data-target=".collapseAnnotation{{id}}" aria-expanded="false" aria-controls="collapseAnnotation{{id}}" title="{{#str}}toggleannotation, mod_margic{{/str}}"><i class="fa fa-lg fa-caret-down"></i></button>
                        </div>
                        <div class="collapse collapseAnnotation collapseAnnotation{{id}}">
                            <div class="d-flex justify-content-between annotationauthor">
                                <span>
                                    {{{userpicturestr}}}
                                </span>
                                <span class="align-self-center">
                                    {{^timemodified}}{{#userdate}}{{timecreated}}, {{#str}} strftimedatetimeshort, core_langconfig {{/str}}{{/userdate}} <i class="fa fa-hourglass-start" aria-hidden="true" title="{{#str}}annotationcreated, margic, {{#userdate}}{{timecreated}}, {{#str}} strftimedaydatetime, core_langconfig {{/str}}{{/userdate}} {{/str}}"></i> {{/timemodified}}
                                    {{#timemodified}}{{#userdate}}{{timemodified}}, {{#str}} strftimedatetimeshort, core_langconfig {{/str}}{{/userdate}} <i class="fa fa-hourglass-end" aria-hidden="true" title="{{#str}}annotationmodified, margic, {{#userdate}}{{timemodified}}, {{#str}} strftimedaydatetime, core_langconfig {{/str}}{{/userdate}} {{/str}}"></i>{{/timemodified}}
                                </span>
                            </div>
                            <div class="annotatedtextpreviewdiv">
                                <span id="annotationpreview-{{id}}" class="annotatedtextpreview annotationpreview-{{id}}" style="border-color: #{{color}};">{{#str}}annotatedtextnotfound, mod_margic {{/str}} <i class="fa fa-exclamation text-danger" aria-hidden="true" title="{{#str}}annotatedtextinvalid, margic {{/str}}"></i></span>
                            </div>
                            <span class="annotation">
                                {{#text}}{{text}}{{/text}}
                                {{^text}}-{{/text}}
                            </span>
                            {{#canbeedited}}
                                <span class="pull-right"><a href="javascript:void(0);" title="{{#str}}editannotation, margic {{/str}}"><i id="edit-annotation-{{id}}" class="fa fa-lg fa-pencil m-r-1 edit-annotation" aria-hidden="true" ></i></a><a href="annotations.php?id={{cmid}}&deleteannotation={{id}}" title="{{#str}}deleteannotation, margic {{/str}}"><i id="delete-annotation-{{id}}" class="fa fa-lg fa-trash delete-annotation" aria-hidden="true"></i></a></span>
                            {{/canbeedited}}
                        </div>
                    </div>
                {{/annotations}}

                {{#annotationform}}
                    <div class="annotation-box annotation-form annotation-form-{{id}}" style="background: {{entrytextbgc}};">
                        <div class="annotatedtextpreviewdiv">
                            <span id="annotationpreview-temp-{{id}}" class="annotatedtextpreview">{{#str}}annotatedtextnotfound, mod_margic {{/str}} <i class="fa fa-exclamation text-danger" aria-hidden="true" title="{{#str}}annotatedtextinvalid, margic {{/str}}"></i></span>
                        </div>
                        {{{annotationform}}}
                    </div>
                {{/annotationform}}
            </div>
        {{/annotationmode}}
    </div>
</div>